<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Scaling Down Text Encoders of Text-to-Image Diffusion Models">
  <meta name="keywords" content="Nerfies, D-NeRF, NeRF">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Nerfies: Deformable Neural Radiance Fields</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<!-- <nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://keunhong.com">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://hypernerf.github.io">
            HyperNeRF
          </a>
          <a class="navbar-item" href="https://nerfies.github.io">
            Nerfies
          </a>
          <a class="navbar-item" href="https://latentfusion.github.io">
            LatentFusion
          </a>
          <a class="navbar-item" href="https://photoshape.github.io">
            PhotoShape
          </a>
        </div>
      </div>
    </div>

  </div>
</nav> -->


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Scaling Down Text Encoders of Text-to-Image Diffusion Models</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="">Lifu Wang</a><sup>1, 2</sup>,</span>
            <span class="author-block">
              <a href="">Daqing Liu</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="">Xinchen Liu</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="">Xiaodong He</a><sup>1</sup>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Jingdong Explore Academy,</span>
            <span class="author-block"><sup>2</sup>Georgia Institute of Technology</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/google/nerfies"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<div class="columns is-centered has-text-centered">
  <div class="column is-four-fifths">
    <h2 class="title is-3">The scaling down pattern</h2>
    <div class="content has-text-justified">
      <p>
        We distilled T5-XXL into a series of smaller T5 models and evaluated their
        performance in guiding image synthesis across three key dimensions: 
        image quality, semantic understanding, and text-rendering. We treat T5-XXLâ€™s performance as
        baseline. Our findings indicate that while image quality and semantic understanding 
        remain largely intact, text-rendering is more sensitive to reductions in model size.
        Our T5-Base achieves <b><font color="red"> 50x memory compression</font></b>.
        On consumer-grade GPUs, our T5-Base achieves <b><font color="red">2.7x latency speedup</font></b>
        compared to T5-XXL with CPU offload.
      </p>
      <div class="grid">
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img loading="lazy" src="static/images/Figure_1.jpg" style="max-width: 100%; height: auto; width: 500px; margin: 20px auto; display: block;"/>
        </div>
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img loading="lazy" src="static/images/performance.jpg.png" style="max-width: 100%; height: auto; width: 650px; margin: 20px auto; display: block;"/>
        </div>
      </div>
      <!-- <img loading="lazy" src="static/images/Figure_1.jpg" style="max-width: 100%; height: auto; width: 500px; margin: 20px auto; display: block;"/> -->
    </div>
  </div>
</div>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <h2 class="subtitle has-text-centered">
        Visualization of the scaling down pattern.
      </h2>
      <img src="./static/images/different_t5.jpg"
                 class="interpolation-image"
                 alt="Interpolation end reference image."/>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Text encoders in diffusion models have rapidly evolved, transitioning from CLIP to T5-XXL. 
            Although this evolution has significantly enhanced the models' ability to understand complex 
            prompts and generate text, it also leads to a substantial increase in the number of parameters. 
            Despite T5 series encoders being trained on the C4 natural language corpus, which includes a 
            significant amount of non-visual data, diffusion models with T5 encoder do not respond to those 
            non-visual prompts, indicating redundancy in repfresentational power. Therefore, it raises an 
            important question: "Do we really need such a large text encoder?" In pursuit of an answer, 
            we employ vision-based knowledge distillation to train a series of T5 encoder models.
            To fully inherit T5-XXL's capabilities, we constructed our dataset based on three criteria: 
            image quality, semantic understanding, and text-rendering. Our results demonstrate the scaling 
            down pattern that the distilled T5-base model can generate images of comparable quality to those 
            produced by T5-XXL, while being 50 times smaller in size. This reduction in model size significantly 
            lowers the GPU requirements for running state-of-the-art models such as FLUX and SD3, making 
            high-quality text-to-image generation more accessible.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

  </div>
</section>

<section class="hero is-small">
  <div class="hero-body">
      <div class="container">
          <div id="results-carousel" class="carousel results-carousel">
              <div class="card">
                  <div class="card-image">
                    <img src="./static/images/flux_t5base_0.jpg"  alt="T5-Base0"/>
                  </div>
                  <div class="card-content has-text-centered">Cybernetic geisha, porcelain skin, her headdress adorned with bioluminescent flowers and delicate, glowing wires.</div>
              </div>
              <div class="card">
                  <div class="card-image">
                    <img src="./static/images/flux_t5base_1.jpg"  alt="T5-Base1"/>
                  </div>
                  <div class="card-content has-text-centered">A high fantasy castle floating among the clouds at sunset, surrounded by flying mythical creatures.</div>
              </div>
              <div class="card">
                  <div class="card-image">
                    <img src="./static/images/flux_t5base_2.jpg"  alt="T5-Base2"/>
                  </div>
                  <div class="card-content has-text-centered">An astronaut exploring a mysterious alien landscape, with strange vegetation and a planet rising in the sky.</div>
              </div>
              <div class="card">
                  <div class="card-image">
                    <img src="./static/images/flux_t5base_3.jpg"  alt="T5-Base3"/>
                  </div>
                  <div class="card-content has-text-centered">Novuschroma style cup of coffee with swirling steam.</div>
              </div>
              <div class="card">
                  <div class="card-image">
                    <img src="./static/images/flux_t5base_4.jpg"  alt="T5-Base4"/>
                  </div>
                  <div class="card-content has-text-centered">Baroque ship, beautiful golden mirror sail, golden cumulus clouds, black sky, golden rock.</div>
              </div>
              <div class="card">
                  <div class="card-image">
                    <img src="./static/images/flux_t5base_5.jpg"  alt="T5-Base5"/>
                  </div>
                  <div class="card-content has-text-centered">Japanese-inspired fantasy painting of a lone samurai, silhouetted against a massive full moon, standing beneath a windswept, crimson-leafed tree.</div>
              </div>
              <div class="card">
                  <div class="card-image">
                    <img src="./static/images/flux_t5base_6.jpg"  alt="T5-Base6"/>
                  </div>
                  <div class="card-content has-text-centered">A cybernetic warrior with mechanical arms and glowing red eyes.</div>
              </div>
              <div class="card">
                  <div class="card-image">
                    <img src="./static/images/flux_t5base_7.jpg"  alt="T5-Base7"/>
                  </div>
                  <div class="card-content has-text-centered">A white kitten wearing a majestic golden veil, adorned with a diadem featuring a prominent red gemstone, surrounded by golden filigree.</div>
              </div>
          </div>
      </div>
  </div>
</section>


<section class="hero is-small">
  <div class="hero-body">
      <div class="container is-max-desktop">
          <h2 class="title is-3 has-text-centered">Compatibility with auxiliary modules</h2>
          <h2>The distilled T5-Base is compatible with ControlNet, which controls image generation with additional conditions.
            The checkpoint can be found <a href="https://huggingface.co/Shakker-Labs/FLUX.1-dev-ControlNet-Union-Pro">here</a>.
          </h2>
          <img loading="lazy" src="static/images/controlnet.jpg"/>
          <h2>In addition, we assess its compatibility with LoRA, a method that efficiently updates the weights of the base diffusion model.
            We use <a href="https://huggingface.co/prithivMLmods/Canopus-LoRA-Flux-Anime">prithivMLmods/Canopus-LoRA-Flux-Anime</a>.
          </h2>
          <img loading="lazy" src="static/images/lora.jpg"/>
          <h2>We also examine whether T5-Base is compatible with a step-distilled model. We use 
            <a href="https://huggingface.co/black-forest-labs/FLUX.1-schnell">FLUX.1-schnell</a>.
          </h2>
          <img loading="lazy" src="static/images/schnell.jpg"/>
      </div>
  </div>
</section>

<div class="container is-max-desktop">
  <div class="rows is-centered">
    <div class="row">
      <h2 class="title is-3 has-text-centered">More comparison between our T5-Base and T5-XXL</h2>
    </div>

    <br><br>
    
    <div class="comparison-set">
      <p style="text-align: center;">Portrait of a stylish young woman wearing a futuristic golden bodysuit
         that creates a metallic, mirror-like effect. She is wearing large, reflective blue-tinted aviator 
         sunglasses. Over her head, she wears headphones with metallic accents.</p><br> <!-- Replace with your actual text prompt -->
      <div class="grid">
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img src="static/images/base_img1.jpg" alt="T5-Base" style="max-width: 100%;">
          <p class="image-label"><strong>T5-Base</strong></p>
        </div>
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img src="static/images/xxl_img1.jpg" alt="T5-XXL" style="max-width: 100%;">
          <p class="image-label"><strong>T5-XXL</strong></p>
        </div>
      </div>
    </div>
    <div class="comparison-set">
      <p style="text-align: center;">Haunting dark fantasy illustration of an ancient, 
        twisted statue standing atop a steep cliff, overseeing a decaying metropolis 
        shrouded in mist. The sky churns with ominous clouds and flashes of lightning.</p><br> <!-- Replace with your actual text prompt -->
      <div class="grid">
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img src="static/images/base_img2.jpg" alt="T5-Base" style="max-width: 100%;">
          <p class="image-label"><strong>T5-Base</strong></p>
        </div>
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img src="static/images/xxl_img2.jpg" alt="T5-XXL" style="max-width: 100%;">
          <p class="image-label"><strong>T5-XXL</strong></p>
        </div>
      </div>
    </div>
    <div class="comparison-set">
      <p style="text-align: center;">An airplane in front of a clock.</p><br> <!-- Replace with your actual text prompt -->
      <div class="grid">
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img src="static/images/base_img3.jpg" alt="T5-Base" style="max-width: 100%;">
          <p class="image-label"><strong>T5-Base</strong></p>
        </div>
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img src="static/images/xxl_img3.jpg" alt="T5-XXL" style="max-width: 100%;">
          <p class="image-label"><strong>T5-XXL</strong></p>
        </div>
      </div>
    </div>
    <div class="comparison-set">
      <p style="text-align: center;">Four people gathered for a picnic.</p><br> <!-- Replace with your actual text prompt -->
      <div class="grid">
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img src="static/images/base_img4.jpg" alt="T5-Base" style="max-width: 100%;">
          <p class="image-label"><strong>T5-Base</strong></p>
        </div>
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img src="static/images/xxl_img4.jpg" alt="T5-XXL" style="max-width: 100%;">
          <p class="image-label"><strong>T5-XXL</strong></p>
        </div>
      </div>
    </div>
    <div class="comparison-set">
      <p style="text-align: center;">A robot displaying the word 'efficiency'.</p><br> <!-- Replace with your actual text prompt -->
      <div class="grid">
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img src="static/images/base_img5.jpg" alt="T5-Base" style="max-width: 100%;">
          <p class="image-label"><strong>T5-Base</strong></p>
        </div>
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img src="static/images/xxl_img5.jpg" alt="T5-XXL" style="max-width: 100%;">
          <p class="image-label"><strong>T5-XXL</strong></p>
        </div>
      </div>
    </div>
    <div class="comparison-set">
      <p style="text-align: center;">A tree displaying the word 'i'm lost'.</p><br> <!-- Replace with your actual text prompt -->
      <div class="grid">
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img src="static/images/base_img6.jpg" alt="T5-Base" style="max-width: 100%;">
          <p class="image-label"><strong>T5-Base</strong></p>
        </div>
        <div class="grid-item" style="width: 49%; display: inline-block; text-align: center;">
          <img src="static/images/xxl_img6.jpg" alt="T5-XXL" style="max-width: 100%;">
          <p class="image-label"><strong>T5-XXL</strong></p>
        </div>
      </div>
    </div>
  </div>
</div>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{park2021nerfies,
  author    = {Park, Keunhong and Sinha, Utkarsh and Barron, Jonathan T. and Bouaziz, Sofien and Goldman, Dan B and Seitz, Steven M. and Martin-Brualla, Ricardo},
  title     = {Nerfies: Deformable Neural Radiance Fields},
  journal   = {ICCV},
  year      = {2021},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
